# -*- coding: utf-8 -*-
"""Calories burnt prediction.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1DnoL0jd-5u5gL7k_9qh8eaH259qHCl3J
"""

import pandas as pd
import numpy as np
import seaborn as sns
from xgboost import XGBRegressor
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.model_selection import train_test_split
from sklearn import metrics

calorie = pd.read_csv('/content/drive/MyDrive/ML datasets/Calories burnt prediction/calories.csv')
exercize_data = pd.read_csv('/content/drive/MyDrive/ML datasets/Calories burnt prediction/exercise.csv')
calorie_data = pd.concat([exercize_data, calorie['Calories']], axis = 1)
calorie_data.head()

calorie_data.shape

calorie_data.isnull().sum()

calorie_data.describe()

#data visualization

sns.distplot(calorie_data['Age'])

sns.distplot(calorie_data['Heart_Rate'])

sns.distplot(calorie_data['Height'])

sns.distplot(calorie_data['Weight'])

"""Now we will see the heatmap to observe the correlation of of the features of our data"""

correlation = calorie_data.corr()

plt.figure(figsize = (10,10))
sns.heatmap(correlation, cbar = True, square = True, fmt = '.1f', annot = True, annot_kws = {'size':8}, cmap= 'Blues')

"""Converting text data to numerical values:"""

calorie_data.replace({'Gender':{'male':1, 'female': 0}}, inplace = True)

calorie_data.head()

"""Now the main part"""

x = calorie_data.drop(['User_ID', 'Calories'], axis = 1)
y = calorie_data['Calories']

print(y)

x_train, x_test, y_train, y_test = train_test_split(x, y, test_size = 0.2, random_state = 2)

print(x.shape, x_train.shape, x_test.shape, y.shape, y_train.shape, y_test.shape)

regressor = XGBRegressor()

regressor.fit(x_train, y_train)
x_train_prediction = regressor.predict(x_test)
accuracy = metrics.mean_absolute_error(y_test, x_train_prediction)

print(accuracy)

